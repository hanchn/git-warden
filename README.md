# Git Warden ä½¿ç”¨è¯´æ˜ï¼ˆå‚»ç“œå¼æ•™ç¨‹ï¼‰

> ğŸ›¡ï¸ Git Wardenï¼šé€šè¿‡ `.gitlintrc.json` é…ç½®è‡ªåŠ¨çº¦æŸ commit æ ¼å¼ã€åˆ†æ”¯å‘½åã€åˆå¹¶è¡Œä¸ºã€‚

---

## âœ… 1. åˆå§‹åŒ–é¡¹ç›®ï¼ˆåªåšä¸€æ¬¡ï¼‰

ç¡®ä¿ä½ å½“å‰ç›®å½•æ˜¯ä¸€ä¸ª Git ä»“åº“ï¼š

```bash
git init  # å¦‚æœè¿˜æ²¡åˆå§‹åŒ– Git ä»“åº“
```

ç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…ä¾èµ–ï¼š

```bash
npm install --save-dev husky
```

---

## âœ… 2. æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬

```bash
node init-warden.js
```

å®ƒä¼šè‡ªåŠ¨ï¼š
- åˆå§‹åŒ– Husky
- æ·»åŠ  `.husky/commit-msg` å’Œ `.husky/pre-push` é’©å­
- è‡ªåŠ¨å†™å…¥ `node warden.js`ï¼ˆé˜²æ­¢é‡å¤ï¼‰
- ç”Ÿæˆ `.gitlintrc.json` é»˜è®¤é…ç½®

---

## âœ… 3. å¼€å§‹ä½¿ç”¨

æ­¤æ—¶ä½ æ— éœ€æ‰‹åŠ¨æ“ä½œï¼Œç›´æ¥åƒå¾€å¸¸ä¸€æ ·å¼€å‘ï¼š

```bash
git add .
git commit -m "feat(core): åˆå§‹åŒ–é¡¹ç›®ç»“æ„"  âœ… æ ¼å¼æ­£ç¡®
```

```bash
git commit -m "ä¿®å¤bug"  âŒ æŠ¥é”™ï¼æ ¼å¼ä¸å¯¹
```

```bash
git push  # æ¨é€å‰è‡ªåŠ¨æ£€æŸ¥åˆ†æ”¯/åˆå¹¶è§„åˆ™
```

---

## âœ… 4. é¡¹ç›®æ ¡éªŒè§„åˆ™ï¼ˆé»˜è®¤ï¼‰

- âœ… commit æ ¼å¼ï¼š`<type>(<scope>): <subject>`
- âœ… commit ä¸èƒ½ä¸ºç©ºæˆ–çº¯ç¬¦å·
- âœ… åˆ†æ”¯å‘½åè§„èŒƒï¼šå¦‚ `test`, `test/xxx`ï¼Œä¸å…è®¸è£¸ `dev`
- âœ… ç¦æ­¢æŸäº›åˆ†æ”¯åˆå¹¶åˆ° masterï¼ˆå¦‚ test â†’ masterï¼‰
- âœ… æ‰€æœ‰é”™è¯¯ä¿¡æ¯éƒ½ä¸ºä¸­æ–‡ï¼Œä¸”å¯åœ¨ `.gitlintrc.json` è‡ªå®šä¹‰

---

## âœ… 5. è‡ªå®šä¹‰é…ç½®ï¼š`.gitlintrc.json`

```json
{
  "forceCommitFormat": true,
  "commitFormat": "<type>(<scope>): <subject>",
  "allowedTypes": ["feat", "fix", "docs", "test", "refactor", "chore"],
  "branches": {
    "main": "^master$",
    "test": "^test(\/.*)?$",
    "pre": "^pre(\/.*)?$",
    "dev": "^dev\/.+$"
  },
  "restrictMerge": [
    { "from": "^test(\/.*)?$", "to": "^master$" },
    { "from": "^pre(\/.*)?$", "to": "^master$" },
    { "from": "^dev\/.+$", "to": "^master$" }
  ],
  "messages": {
    "emptyCommit": "âŒ commit ä¿¡æ¯ä¸èƒ½ä¸ºç©ºï¼Œä¸”ä¸èƒ½æ˜¯çº¯ç¬¦å·ï¼Œè¯·å¡«å†™æœ‰æ„ä¹‰çš„æäº¤å†…å®¹",
    "badFormat": "âŒ commit ä¿¡æ¯æ ¼å¼é”™è¯¯ï¼Œå¿…é¡»ç¬¦åˆæ ¼å¼ï¼š<type>(<scope>): <subject>",
    "badType": "âŒ commit ç±»å‹ä¸åœ¨å…è®¸èŒƒå›´å†…ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹ç±»å‹ä¹‹ä¸€ï¼š",
    "badBranch": "âŒ å½“å‰åˆ†æ”¯ä¸ç¬¦åˆå‘½åè§„èŒƒï¼Œå…·ä½“è§„èŒƒå¦‚ä¸‹ï¼š",
    "badMerge": "âŒ ç¦æ­¢å°†è¯¥åˆ†æ”¯åˆå¹¶åˆ°ç›®æ ‡åˆ†æ”¯ï¼Œè¯·æ£€æŸ¥åˆå¹¶ç­–ç•¥"
  }
}
```

---

## âœ… å¸¸è§é—®é¢˜æ’æŸ¥

| é—®é¢˜                                       | è§£å†³æ–¹æ¡ˆ                                       |
|--------------------------------------------|------------------------------------------------|
| æŠ¥é”™ï¼š`.husky/_/husky.sh: No such file`     | æ‰§è¡Œ `npx husky install` ä¿®å¤                   |
| é’©å­æ–‡ä»¶æ— æƒé™æ‰§è¡Œ                         | è¿è¡Œ `chmod +x .husky/commit-msg`               |
| `node` å‘½ä»¤æœªæ‰¾åˆ°                          | ç¡®ä¿æœ¬æœºå·²å®‰è£… Node.js å¹¶åŠ å…¥ç¯å¢ƒå˜é‡           |

---

## ğŸ‰ å®Œæˆï¼

ä½ çš„ Git é¡¹ç›®ç°åœ¨å·²ç»è¢« Git Warden æ¥ç®¡ï¼Œä»»ä½•æäº¤/æ¨é€éƒ½ä¼šè‡ªåŠ¨æ ¡éªŒã€‚

æœ‰é—®é¢˜éšæ—¶æ‰§è¡Œï¼š
```bash
node warden.js  # æ‰‹åŠ¨è¿è¡Œæ ¡éªŒ
```

æ¬¢è¿å‡çº§ä¸º CLI å·¥å…·å‘å¸ƒï¼Œæ”¯æŒå›¢é˜Ÿä¸€é”®é›†æˆï¼